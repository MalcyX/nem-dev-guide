<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Hugo 0.20.6" />
    <meta name="description" content="Resources for using and developing on NEM">
<meta name="author" content="Nem Project">

    <link rel="shortcut icon" href="https://rb2nem.github.io/nem-dev-guide/images/favicon.png" type="image/x-icon" />

    
    <title>Developing an application</title>
    <link href="https://rb2nem.github.io/nem-dev-guide//css/nucleus.css" rel="stylesheet">
    <link href="https://rb2nem.github.io/nem-dev-guide//css/font-awesome.min.css" rel="stylesheet">
    <link href="https://rb2nem.github.io/nem-dev-guide//css/hybrid.css" rel="stylesheet">
    <link href="https://rb2nem.github.io/nem-dev-guide//css/featherlight.min.css" rel="stylesheet">
    <link href="https://rb2nem.github.io/nem-dev-guide//css/perfect-scrollbar.min.css" rel="stylesheet">
    <link href="https://rb2nem.github.io/nem-dev-guide//css/horsey.css" rel="stylesheet">
    <link href="https://rb2nem.github.io/nem-dev-guide//css/theme.css" rel="stylesheet">
    <link href="https://rb2nem.github.io/nem-dev-guide//css/hugo-theme.css" rel="stylesheet">
    <script src="https://rb2nem.github.io/nem-dev-guide//js/jquery-2.x.min.js"></script>
    <style type="text/css">:root #header + #content > #left > #rlblock_left
    {display:none !important;}</style>
    <link rel="stylesheet" type="text/css" href="https://rb2nem.github.io/nem-dev-guide/css/ansi.css">
<link rel="stylesheet" type="text/css" href="https://rb2nem.github.io/nem-dev-guide/css/custom.css">
<link rel="stylesheet" type="text/css" href="https://rb2nem.github.io/nem-dev-guide/css/tabs.css">

  </head>
  <body class="" data-url="/10-offline-signer/">
    <nav id="sidebar">
  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="http://nem.io">
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 width="505px" height="140px" viewBox="0 0 3000 768" enable-background="new 0 0 1024 768" xml:space="preserve">
<g>
	<path d="M843.539,452.711c-0.433-0.236-0.801-0.424-1.157-0.633c-46.801-27.406-82.187-72.52-96.589-126.548
		c-2.278-8.547-3.988-17.208-5.161-25.978c-1.185-8.855-1.769-17.749-1.846-26.679c-0.013-1.536-0.151-1.286,1.163-2.032
		c17.586-9.983,36.219-17.286,55.92-21.864c7.273-1.69,14.614-2.992,22.024-3.893c10.196-1.24,20.431-1.749,30.699-1.491
		c5.752,0.144,11.49,0.515,17.215,1.125c28.694,3.059,55.605,11.685,80.752,25.83c0.363,0.204,0.715,0.431,1.089,0.614
		c0.426,0.208,0.617,0.519,0.595,0.994c-0.023,0.499-0.003,1-0.01,1.5c-0.075,5.17-0.279,10.335-0.71,15.488
		c-0.62,7.399-1.611,14.748-3.013,22.04c-3.009,15.659-7.736,30.782-14.241,45.342c-10.328,23.117-24.394,43.687-42.161,61.724
		c-12.825,13.02-27.114,24.17-42.852,33.463C844.717,452.031,844.176,452.341,843.539,452.711z M748.408,277.983
		c0,0.492,0,0.865,0,1.238c0.006,7.344,0.485,14.66,1.363,21.949c0.792,6.582,1.936,13.106,3.418,19.569
		c0.262,1.14,0.615,2.23,1.116,3.296c8.973,19.098,29.765,29.253,50.382,24.586c15.721-3.559,28.457-15.674,32.831-31.182
		c1.21-4.288,1.622-8.671,1.758-13.095c0.09-2.922,0.364-5.82,0.912-8.693c3.354-17.568,15.104-32.083,31.559-38.969
		c0.922-0.386,1.863-0.726,2.791-1.097c0.131-0.052,0.342-0.069,0.28-0.31c-2.584-0.922-18.114-2.471-27.428-2.654
		c-19.984-0.394-39.567,2.232-58.718,7.973C774.606,264.81,761.214,270.59,748.408,277.983z M895.88,397.8
		c0.549-0.258,0.764-0.681,1.039-1.023c4.029-5.004,7.794-10.2,11.284-15.594c12.539-19.381,21.288-40.339,26.164-62.908
		c1.657-7.668,2.824-15.409,3.51-23.224c0.467-5.319,0.728-10.645,0.731-15.984c0-0.368-0.037-0.736-0.057-1.102
		c-0.519-0.305-0.98-0.587-1.45-0.852c-4.103-2.315-8.279-4.49-12.548-6.482c-6.157-2.872-12.401-5.531-18.893-7.567
		c-7.902-2.477-15.885-2.753-23.937-0.811c-22.921,5.527-37.569,27.962-33.229,51.127c2.406,12.845,9.297,22.754,20.348,29.75
		c0.739,0.468,1.495,0.91,2.242,1.367c8.074,4.941,14.401,11.558,18.921,19.87c4.753,8.742,6.891,18.096,6.341,28.043
		C896.25,394.154,896.048,395.892,895.88,397.8z M843.611,442.505c0.41-0.232,0.881-0.49,1.343-0.762
		c12.597-7.408,24.162-16.183,34.771-26.227c0.677-0.641,1.2-1.382,1.619-2.204c0.68-1.337,1.372-2.669,2.023-4.021
		c5.02-10.435,6.096-21.246,2.766-32.359c-6.474-21.606-27.306-34.004-48.165-31.397c-5.96,0.745-11.538,2.643-16.738,5.564
		c-9.94,5.584-20.541,7.885-31.883,6.801c-5.565-0.532-10.898-1.954-16.014-4.199c-4.029-1.768-7.769-4.018-11.242-6.718
		c-0.242-0.188-0.514-0.336-0.964-0.628c0.149,0.496,0.21,0.77,0.312,1.029c4.455,11.367,9.974,22.194,16.535,32.49
		c7.082,11.114,15.234,21.381,24.444,30.806c9.211,9.425,19.292,17.806,30.234,25.149
		C837.466,439.057,842.13,441.906,843.611,442.505z"/>
	<path fill="#F7A800" d="M748.408,277.983c12.806-7.392,26.198-13.173,40.263-17.389c19.151-5.741,38.735-8.367,58.718-7.973
		c9.314,0.184,24.844,1.732,27.428,2.654c0.062,0.241-0.149,0.257-0.28,0.31c-0.928,0.37-1.869,0.711-2.791,1.097
		c-16.455,6.886-28.205,21.401-31.559,38.969c-0.548,2.873-0.823,5.771-0.912,8.693c-0.136,4.424-0.548,8.807-1.758,13.095
		c-4.374,15.508-17.11,27.623-32.831,31.182c-20.617,4.667-41.408-5.488-50.382-24.586c-0.501-1.067-0.854-2.156-1.116-3.296
		c-1.482-6.464-2.626-12.987-3.418-19.569c-0.877-7.289-1.357-14.605-1.363-21.949C748.408,278.848,748.408,278.474,748.408,277.983
		z"/>
	<path fill="#67B2E8" d="M895.88,397.8c0.168-1.908,0.37-3.646,0.466-5.389c0.55-9.947-1.587-19.301-6.341-28.043
		c-4.52-8.313-10.847-14.929-18.921-19.87c-0.746-0.457-1.502-0.899-2.242-1.367c-11.051-6.996-17.942-16.905-20.348-29.75
		c-4.34-23.165,10.309-45.6,33.229-51.127c8.052-1.942,16.035-1.666,23.937,0.811c6.492,2.035,12.737,4.694,18.893,7.567
		c4.269,1.992,8.445,4.167,12.548,6.482c0.47,0.265,0.931,0.547,1.45,0.852c0.02,0.365,0.058,0.733,0.057,1.102
		c-0.003,5.339-0.264,10.665-0.731,15.984c-0.686,7.815-1.854,15.556-3.51,23.224c-4.876,22.569-13.625,43.527-26.164,62.908
		c-3.49,5.394-7.255,10.59-11.284,15.594C896.644,397.119,896.429,397.542,895.88,397.8z"/>
	<path fill="#00C4B3" d="M843.611,442.505c-1.481-0.599-6.145-3.447-10.959-6.678c-10.943-7.343-21.023-15.724-30.234-25.149
		c-9.211-9.425-17.363-19.691-24.444-30.806c-6.56-10.296-12.079-21.122-16.535-32.49c-0.101-0.259-0.163-0.533-0.312-1.029
		c0.451,0.292,0.723,0.44,0.964,0.628c3.473,2.7,7.214,4.95,11.242,6.718c5.116,2.246,10.449,3.668,16.014,4.199
		c11.342,1.084,21.943-1.217,31.883-6.801c5.201-2.921,10.778-4.819,16.738-5.564c20.859-2.607,41.691,9.792,48.165,31.397
		c3.33,11.113,2.254,21.924-2.766,32.359c-0.65,1.352-1.343,2.684-2.023,4.021c-0.418,0.822-0.942,1.564-1.619,2.204
		c-10.609,10.044-22.175,18.819-34.771,26.227C844.492,442.015,844.021,442.273,843.611,442.505z"/>
	<path d="M75.119,348.956h49.132v24.767c2.798-3.687,5.87-7.217,9.212-10.582c3.339-3.362,7.056-6.342,11.152-8.949
		c4.09-2.605,8.616-4.666,13.575-6.187c4.955-1.521,10.556-2.282,16.808-2.282c18.746,0,33.236,5.712,43.473,17.131
		c10.233,11.423,15.353,27.151,15.353,47.19v112.161h-49.13v-96.408c0-11.606-2.587-20.369-7.757-26.277
		c-5.172-5.91-12.501-8.87-21.981-8.87c-9.484,0-16.97,2.96-22.465,8.87c-5.493,5.908-8.242,14.671-8.242,26.277v96.408H75.119
		V348.956z"/>
	<path d="M354.988,526.084c-12.928,0-24.945-2.157-36.039-6.464c-11.102-4.309-20.687-10.45-28.767-18.425
		c-8.082-7.969-14.385-17.398-18.909-28.283c-4.526-10.879-6.789-22.999-6.789-36.363v-0.646c0-12.282,2.101-23.919,6.302-34.907
		c4.204-10.99,10.072-20.576,17.618-28.767c7.54-8.188,16.535-14.652,26.99-19.394c10.448-4.738,22.029-7.112,34.747-7.112
		c14.435,0,26.934,2.585,37.494,7.757c10.556,5.172,19.34,12.12,26.344,20.849c7,8.726,12.172,18.748,15.515,30.059
		c3.339,11.312,5.011,23.112,5.011,35.394c0,1.939-0.056,3.99-0.161,6.141c-0.112,2.157-0.273,4.419-0.484,6.789H313.293
		c2.368,11.206,7.271,19.667,14.706,25.373c7.435,5.712,16.647,8.565,27.637,8.565c8.186,0,15.515-1.397,21.979-4.202
		c6.466-2.798,13.141-7.323,20.041-13.576l28.12,24.889c-8.192,10.131-18.1,18.05-29.736,23.759
		C384.404,523.226,370.716,526.084,354.988,526.084z M386.666,422.004c-1.511-10.989-5.39-19.879-11.636-26.666
		c-6.253-6.789-14.546-10.183-24.889-10.183c-10.345,0-18.698,3.345-25.05,10.022c-6.358,6.681-10.506,15.626-12.445,26.827H386.666
		z"/>
	<path d="M465.163,348.956h49.132v24.767c2.798-3.687,5.87-7.217,9.212-10.582c3.339-3.362,7.056-6.342,11.152-8.949
		c4.09-2.605,8.67-4.666,13.737-6.187c5.061-1.521,10.717-2.282,16.97-2.282c11.419,0,21.277,2.388,29.575,7.161
		c8.294,4.778,14.708,11.61,19.232,20.51c7.54-9.111,15.945-16.005,25.212-20.671c9.264-4.666,19.824-7,31.677-7
		c18.313,0,32.646,5.39,42.989,16.161c10.345,10.779,15.517,26.617,15.517,47.515v112.806h-49.132v-96.408
		c0-11.606-2.479-20.369-7.435-26.277c-4.959-5.91-12.071-8.87-21.333-8.87c-9.268,0-16.541,2.96-21.819,8.87
		c-5.282,5.908-7.919,14.671-7.919,26.277v96.408h-49.13v-96.408c0-11.606-2.479-20.369-7.435-26.277
		c-4.959-5.91-12.071-8.87-21.333-8.87c-9.268,0-16.541,2.96-21.819,8.87c-5.282,5.908-7.919,14.671-7.919,26.277v96.408h-49.132
		V348.956z"/>
</g>
</svg>
</a>

    </div>
    
</div>


  <div class="highlightable">
    <ul class="topics">
      
      
        
      
      
      
      

      
        
      
      
      

      <li class="dd-item  parent" data-nav-id="/">
        <a href="https://rb2nem.github.io/nem-dev-guide/">
          <span>
            
              <b>NEM Developer's Guide</b>
            
             NEM&#39;s Developer Guide
            
           </span>
        </a>
        
        <ul>
          
          
          
          
            <li class="dd-item " data-nav-id="/01-intro/">
              <a href="https://rb2nem.github.io/nem-dev-guide/01-intro/">
                <span>Introduction     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/02-about/">
              <a href="https://rb2nem.github.io/nem-dev-guide/02-about/">
                <span>About this guide     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/03-setting-up-environment/">
              <a href="https://rb2nem.github.io/nem-dev-guide/03-setting-up-environment/">
                <span>Setting up the environment     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/03b-accounts/">
              <a href="https://rb2nem.github.io/nem-dev-guide/03b-accounts/">
                <span>NEM Accounts     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/04-blockchain-requests/">
              <a href="https://rb2nem.github.io/nem-dev-guide/04-blockchain-requests/">
                <span>Blockchain requests     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/04b-account-requests/">
              <a href="https://rb2nem.github.io/nem-dev-guide/04b-account-requests/">
                <span>Account requests     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/05-transaction-overview/">
              <a href="https://rb2nem.github.io/nem-dev-guide/05-transaction-overview/">
                <span>Transactions Overview     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/06-transaction-transfer/">
              <a href="https://rb2nem.github.io/nem-dev-guide/06-transaction-transfer/">
                <span>Transfer Transactions     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/07-monitoring-blockchain/">
              <a href="https://rb2nem.github.io/nem-dev-guide/07-monitoring-blockchain/">
                <span>Monitoring the blockchain     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/08-multisig-accounts/">
              <a href="https://rb2nem.github.io/nem-dev-guide/08-multisig-accounts/">
                <span>Managing and using multisig accounts     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/09-mosaics/">
              <a href="https://rb2nem.github.io/nem-dev-guide/09-mosaics/">
                <span>Namespaces and Mosaics     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item active" data-nav-id="/10-offline-signer/">
              <a href="https://rb2nem.github.io/nem-dev-guide/10-offline-signer/">
                <span>Developing an application     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/80-debugging/">
              <a href="https://rb2nem.github.io/nem-dev-guide/80-debugging/">
                <span>Debugging     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/90-snippets/">
              <a href="https://rb2nem.github.io/nem-dev-guide/90-snippets/">
                <span>Code snippets     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/95-running-node/">
              <a href="https://rb2nem.github.io/nem-dev-guide/95-running-node/">
                <span>Running a node     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/99-references/">
              <a href="https://rb2nem.github.io/nem-dev-guide/99-references/">
                <span>References     </i></span>
              </a>
            </li>
          
          
        </ul>
        
      </li>
      
      
    </ul>
    <hr>
     
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fa fa-heart"></i></a> from <a href="http://getgrav.org">Grav</a> and <a href="http://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>

        <section id="body">
        <div id="overlay"></div>

        <div class="padding highlightable">

            <div id="top-bar">
              
                
                
                
              <div id="top-github-link">
                  <a class="github-link" href="https://github.com/rb2nem/nem-dev-guide/edit/master/website/content/10-offline-signer.md" target="blank">
                    <i class="fa fa-code-fork"></i>
                    Edit this page
                  </a>
              </div>
                
              
              <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                  <span id="sidebar-toggle-span">
                      <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                        <i class="fa fa-bars"></i>
                      </a>
                  </span>
                
                <span id="toc-menu"><a href=""><i class="fa fa-list-alt"></i></a></span>
                
                
                
                
                  
                
                <span itemprop="title"> Developing an application</span>
              </div>
              
                  <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#security-consideration">Security consideration</a></li>
<li><a href="#electron-offline-signer">Electron Offline signer</a>
<ul>
<li><a href="#dependencies">Dependencies</a></li>
<li><a href="#window-content">Window content</a></li>
<li><a href="#code">Code</a></li>
</ul></li>
<li><a href="#single-file-offline-signer">Single file offline signer</a>
<ul>
<li><a href="#step-1">Step 1</a></li>
<li><a href="#step-2">Step 2</a></li>
<li><a href="#step-3">Step 3</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

              

            </div>
            
    	        <div id="body-inner">
                
                <h1>Developing an application</h1>
                



<p>In this chapter we will develop a small application: an offline transfer transactions signer for the test network.
It will consist of a desktop application built on Electron, that will let you generate and a transaction
without network connection. It is a way to secure a private key from being compromised. Adapting the applications
to work on the main net is trivial (we will underline what minor changes are needed).</p>

<p>When the signed transaction has been generated, it needs to be broadcasted to the network. That will be done
from an Android application. The Android application will scan a QR-code displayed by the desktop application, and
will send the encoded transaction to the NEM network.</p>

<h2 id="security-consideration">Security consideration</h2>

<p>It is interesting to note that, if a multisig transaction is generated by the desktop app and another co-signatory is required
to sign the transaction for it to go through, and the co-signatory signing the transaction
has no fund, the user can use this application without the need of trusting the developer of the application.</p>

<p>As another co-signatory needs to sign the transaction, you/he/she can check that the broadcated transaction is what was meant.
Even if the desktop application were infected with malware, it wouldn&rsquo;t be able to fraudulously transfer funds.
And as the Android application is simply a broadcaster of the scanned transaction, it doesn&rsquo;t and can&rsquo;t compromise the transfer of
funds.</p>

<h2 id="electron-offline-signer">Electron Offline signer</h2>

<p>To develop our desktop offline signer, we will use the <a href="https://github.com/electron/electron-quick-start">electron-quick-start</a> as a base.
We will follow their instructions to install it:</p>

<pre><code># Clone this repository
git clone https://github.com/electron/electron-quick-start
# Go into the repository
cd electron-quick-start
# Install dependencies
npm install
# Run the app
npm start
</code></pre>

<p>If all went well, the last step opens an empty window. This is the base application we will build on.</p>

<h3 id="dependencies">Dependencies</h3>

<p>We first add our dependencies: nem-library, rxjs (for nem-library) and qrcode (to display the transaction as a qrcode).
You add them in <code>package.json</code>, just after the <code>devDependencies</code> entry, like this:</p>

<pre><code>  &quot;devDependencies&quot;: {
    &quot;electron&quot;: &quot;~1.7.8&quot;
  },
  &quot;dependencies&quot;: {
    &quot;nem-library&quot;: &quot;~0.10.0&quot;,
    &quot;rxjs&quot;: &quot;~5.5.0&quot;,
    &quot;qrcode&quot;: &quot;~0.9.0&quot;
   }

</code></pre>

<p>You can see the diff of <a href="https://github.com/rb2nem/electron-quick-start/commit/41d4d0a51964ae3d63720806a627c1acdc93004f">this commit</a> on Github.</p>

<p>Now run the command</p>

<pre><code>npm install
</code></pre>

<p>to install all new dependencies.</p>

<h3 id="window-content">Window content</h3>

<p>We then edit the <code>index.html</code> file. This is the content of the application&rsquo;s window. We need to add input fields to get the data required to
instanciate a transaction. These are:</p>

<ul>
<li>the signer&rsquo;s private key</li>
<li>the recipient of the transfer</li>
<li>the amount of XEMs transferred</li>
<li>the message of the transaction</li>
<li>to be able to sign multisig transactions, we will also include a field for the multisig account&rsquo;s public key</li>
</ul>

<p>Edit the <code>index.html</code> file. You can remove everything inside the <code>&lt;body&gt;</code> tag, except for the <code>&lt;script&gt;</code> tag, which
should be left in place, at the bottom.</p>

<p>In the body tag, we add this old school, table-based, HTML:</p>

<pre><code>&lt;table&gt;
&lt;tr&gt;&lt;td&gt;signer private key:&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;text&quot; id=&quot;pk&quot; size=&quot;64&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;recipient:&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;text&quot; id=&quot;recipient&quot; size=&quot;64&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;amount:&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;text&quot; id=&quot;amount&quot;&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;message:&lt;/td&gt;&lt;td&gt;
    &lt;textarea id=&quot;msg&quot;&gt;&lt;/textarea&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;Multisig public key:&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;text&quot; id=&quot;msig_pubkey&quot; size=&quot;64&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;button id=&quot;send&quot;&gt;SEND&lt;/button&gt;&lt;/td&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;

</code></pre>

<p>With this information provided, we will generated the transfer transaction, sign it with the private key provided, and
serialise it to be broadcasted to the network. This JSON serialised transaction will then be displayed as text and as
 a QR code. The HTML to display both is a <code>div</code> to display the JSON, and a canvas to display the QR-code:</p>

<pre><code>&lt;div style=&quot;width:100%;&quot;&gt;
    &lt;div id=&quot;result&quot; style=&quot;width:75%;word-wrap:break-word;&quot;&gt;
    &lt;/div&gt;
    &lt;canvas id=&quot;canvas&quot;&gt;
    &lt;/canvas&gt;
&lt;/div&gt;
</code></pre>

<p>You can see the diff of <a href="https://github.com/rb2nem/electron-quick-start/commit/991318a57736de0c5844ba5825b7b54f52e63169">this commit</a> on Github.
This results in this window content:</p>


<figure >
    
        <img src="https://rb2nem.github.io/nem-dev-guide/images/app_signer_window_fields.png" />
    
    
    <figcaption>
        <h4>Offline Signer Window</h4>
        
    </figcaption>
    
</figure>


<p>And this is what needs to be tweaked in the application&rsquo;s window content. You
can of course further change the content of the <code>index.html</code> file to better
suit your needs and taste. We will however focus on the code needed to make this app work.</p>

<h3 id="code">Code</h3>

<p>We will start by removing the menu, which we don&rsquo;t use.
This is done by editing the file <code>main.js</code> and adding the line</p>

<pre><code>mainWindow.setMenu(null);
</code></pre>

<p>right after the initialisation of the main window in the function <code>createWindow</code>.</p>

<p>You can see the diff of <a href="https://github.com/rb2nem/electron-quick-start/commit/91f34638efa62c3b87ef8838e0c79d131d7f5a66">this commit</a> on Github.</p>

<p>It is also in <code>main.js</code> that you can activate the developer tools, which are
invaluable when you want to debug your application. To have the developers tools
active, just be sure that this line is not commented:</p>

<pre><code>mainWindow.webContents.openDevTools()
</code></pre>

<p>Here is a screenshot of our app with the dev tool opened:

<figure >
    
        <img src="https://rb2nem.github.io/nem-dev-guide/images/app_dev_tools.png" />
    
    
    <figcaption>
        <h4>Developer tools</h4>
        
    </figcaption>
    
</figure>
</p>

<p>But the bulk of our code is in the file <code>rendered.js</code>.
We start by requiring all dependencies:</p>

<pre><code>const $ = require('jquery');
const nemLibrary = require(&quot;nem-library&quot;);
const NEMLibrary = nemLibrary.NEMLibrary,
    Address = nemLibrary.Address,
    NetworkTypes = nemLibrary.NetworkTypes,
    TimeWindow = nemLibrary.TimeWindow,
    TransferTransaction = nemLibrary.TransferTransaction,
    MultisigTransaction = nemLibrary.MultisigTransaction,
    TransactionHttp = nemLibrary.TransactionHttp,
    XEM = nemLibrary.XEM,
    EmptyMessage = nemLibrary.EmptyMessage,
    Account = nemLibrary.Account,
    PublicAccount = nemLibrary.PublicAccount,
    PlainMessage = nemLibrary.PlainMessage;
const QRCode = require('qrcode');
</code></pre>

<p>We will use jquery in our code, to access elements of the interface we defined
in <code>index.html</code>, and all other lines are nem-library elements we will use.</p>

<p>The first this with nem-library is to bootstrap the environment for the network we will use:</p>

<pre><code>NEMLibrary.bootstrap(NetworkTypes.TEST_NET);
</code></pre>

<p>In our case, it will always be the testnet, but should you want to work on the mainnet, this is the
only line you would change. A final application would probably display a dropdown list or a radio button
to select the network for which to generate the transaction.</p>

<p>We can now write the code to generate the signed transaction and display it as string and qr-code.
We will put this code in the function <code>computeSignedTransaction</code>.</p>

<p>We start by extracting values entered by the user:</p>

<pre><code>        var privateKey = $(&quot;#pk&quot;).val();
        var recipient =  $(&quot;#recipient&quot;).val();
        var amount =  $(&quot;#amount&quot;).val();
        var message = $(&quot;#msg&quot;).val();
        var msig_pubkey = $(&quot;#msig_pubkey&quot;).val();
</code></pre>

<p>With this info, we can create the transfer transaction:</p>

<pre><code>       let transferTransaction = TransferTransaction.create(
           TimeWindow.createWithDeadline(),
           new Address(recipient),
           new XEM(amount),
           PlainMessage.create(message)
       );
</code></pre>

<p>We wanted to also support initiating multisig transactions.
With nem library, handling a multisig transaction is just a question of
wrapping the transfer transaction with a MultisigTransaction.
We will do this only if a public key of the multisig account is provided,
resuting in this code:</p>

<pre><code>       // tx will be the transaction signed.
       // if multisig, it is reassigned below
       let tx = transferTransaction;
    
       // if we have a public key, create a multisig transaction
       if (msig_pubkey!=&quot;&quot;) {
               tx = MultisigTransaction.create(
                   TimeWindow.createWithDeadline(),
                   transferTransaction,
                   PublicAccount.createWithPublicKey(msig_pubkey)
               );
       } 
</code></pre>

<p>We can then sign the transaction with the account for which we received
the private key from the user. We immediately stringify the JSON of the
signed transaction:</p>

<pre><code>       let account = Account.createWithPrivateKey(privateKey);
       let signedTransaction = account.signTransaction(tx);
       let text=JSON.stringify(signedTransaction);
</code></pre>

<p>Now we have the text to display. We set the transaction text ad the content of the div with id <code>result</code>:</p>

<pre><code>       $(&quot;#result&quot;).html(text);

</code></pre>

<p>and we display it as qrcode:</p>

<pre><code>       var canvas = document.getElementById('canvas')
        
       QRCode.toCanvas(canvas,text, function (error) {
         if (error) console.error(error)
       })

</code></pre>

<p>The only thing left to do is attaching our function to the click of button <code>send</code>:</p>

<pre><code>$(&quot;#send&quot;).on('click', computeSignedTransaction);
</code></pre>

<p>That&rsquo;s really all there is.</p>

<p>You can see the diff of <a href="https://github.com/rb2nem/electron-quick-start/commit/4a498f31adb1a30c659548aaeb9040f2f91101f3">this commit</a> on Github.</p>

<p>Here is an example of a signed transaction:</p>


<figure >
    
        <img src="https://rb2nem.github.io/nem-dev-guide/images/app_signer.png" />
    
    
    <figcaption>
        <h4>Offline Signer Result</h4>
        
    </figcaption>
    
</figure>


<h2 id="single-file-offline-signer">Single file offline signer</h2>

<p>If using electron might bring some advantages when the application evolves, in the current state
the added value of using the Electron platform is small. Couldn&rsquo;t we make it a single html file
to be downloaded and opened in the browser? The answer is yes, let&rsquo;s see how we can do it!</p>

<p>The first tool we will use is <a href="https://www.npmjs.com/package/browserify">Browserify</a>, which
lets you use the node&rsquo;s <code>require</code> in the browser. From its own description:</p>

<pre><code>browserify will recursively analyze all the require() calls in your app in order to build a bundle you can serve up to the browser in a single &lt;script&gt; tag
</code></pre>

<p>This leads to a 5MB bundle that we can bring down to 3.3MB by minifying the javascript file.
Once we have the javascript, we can include it in the <code>index.html</code> file as the content of the <code>script</code> tag.</p>

<p>There is not a lot of complexity in these steps, but it is cumbersome and error-prone, so we will automate it.
We will use <a href="https://gruntjs.com/">Grunt</a> as our automation tool.
The steps to automate are:
- bundle all modules used in one javascript file. This is done with browserify.
- minify the javascript file, with uglify
- include the javascript in the <code>index.html</code> file, which is supported by grunt-combine.</p>

<p>Let&rsquo;s first update the <code>devDependencies</code> to this:</p>

<pre><code>  &quot;devDependencies&quot;: {
    &quot;grunt&quot;: &quot;~0.4.1&quot;,
    &quot;grunt-combine&quot;: &quot;~0.8.3&quot;,
    &quot;grunt-browserify&quot;: &quot;5.2.0&quot;,
    &quot;grunt-exec&quot;: &quot;3.0.0&quot;,
    &quot;uglify-js&quot;:&quot;3.1.7&quot;,
    &quot;uglify-js-es6&quot;:&quot;2.8.9&quot;,
    &quot;browserify&quot;: &quot;14.5.0&quot;
  }
</code></pre>

<p>The Gruntfile has this format:</p>

<pre><code>var packageObject = require('./package.json');
  
module.exports = function (grunt) {
        // Project configuration.
        grunt.initConfig({
                pkg: grunt.file.readJSON('package.json'),
                module1: {
                        step: {
                                option: &quot;value&quot;,...
                        }
                      
                }, ...
        });             

        grunt.file.defaultEncoding = 'utf-8';
        grunt.loadNpmTasks(&quot;plugin&quot;);
        grunt.registerTask(&quot;default&quot;, [&quot;module1&quot;,...]);
};               
</code></pre>

<h3 id="step-1">Step 1</h3>

<p>The browserify task is</p>

<pre><code>browserify: {
                scripts: {
                        src: &quot;src/renderer.js&quot;,
                        dest: &quot;tmp/renderer.browserified.js&quot;
                }
            }
</code></pre>

<p>It requires the plugin <code>grunt-browserify</code>, hence we add it to the bottom of the Gruntfile:</p>

<pre><code>grunt.loadNpmTasks('grunt-browserify');
</code></pre>

<p>This will run the <code>browserify</code> command on the file <code>src/renderer.js</code> and generate the file <code>tmp/renderer.browserified.js</code></p>

<h3 id="step-2">Step 2</h3>

<p>To minimize the javascript, we use uglify, but we need it to support the ES6 syntax. That&rsquo;s why we added both <code>uglify-js</code>
and <code>uglify-js-es6</code> to the dev dependencies. And it is why we don&rsquo;t use the grunt plugin for uglify, as the released version doesn&rsquo;t yest
support ES6 syntax. We need to specify the command to run. This is done with</p>

<pre><code>exec: { 
        uglify: 'uglifyjs tmp/renderer.browserified.js &gt; tmp/renderer.uglified.js'
}
</code></pre>

<p>and including the needed plugin:</p>

<pre><code>grunt.loadNpmTasks('grunt-exec');
</code></pre>

<h3 id="step-3">Step 3</h3>

<p>Finally, we can integrate the javascript file in the html file with the <code>combine</code> functionality of Grunt.
This functionality is simply replacing tokens in a file by the content of another file. To make it work,
we edit the <code>index.html</code> file and put the token <code>//bundle.js</code> as somle content of the <code>script</code> tag:</p>

<pre><code>&lt;script type=&quot;text/javascript&quot;&gt;
//bundle.js     
&lt;/script&gt;
</code></pre>

<p>We then define the <code>combine</code> task to replace the token <code>bundle.js</code> but the content of the minified file:</p>

<pre><code>combine: {
        single: {
                input: &quot;src/index.html&quot;,
                output: &quot;dist/offline_signer.html&quot;,
                tokens: [
                        { token: &quot;//bundle.js&quot;, file: &quot;./tmp/renderer.uglified.js&quot; },
                ]
        }
}
</code></pre>

<p>As for other steps, we include the combine plugin:</p>

<pre><code>grunt.loadNpmTasks(&quot;grunt-combine&quot;);
</code></pre>

<p>The complete Gruntfile is <a href="https://github.com/rb2nem/nem-dev-guide/blob/master/files/single_file_signer/Gruntfile.js">available on github</a>.</p>

<p>The complete code is available unde the directory <a href="https://github.com/rb2nem/nem-dev-guide/tree/master/files/single_file_signer">files/single_file_signer</a> of <a href="https://github.com/rb2nem/nem-dev-guide">this repository</a>.</p>

<p>The HTML file built is also in the repository at <a href="https://github.com/rb2nem/nem-dev-guide/blob/master/files/single_file_signer/dist/offline_signer.html">files/single_file_signer/dist/offline_signer.html</a>. You can also <a href="https://rb2nem.github.io/nem-dev-guide/html/single_file_signer/offline_signer.html">open it in your browser</a> as served from this website.</p>

<p>To build the single file NEM transaction signer, simply go in that directory and do</p>

<pre><code>git clone https://github.com/rb2nem/nem-dev-guide.git
cd files/single_file_signer
npm install
grunt
</code></pre>

<p>Open the file <code>dist/offline_signer.html</code>, and you have the same functionality as in the Electron application.</p>


      
      </div>
    </div>

    <div id="navigation">
        
        <a class="nav nav-prev" href="https://rb2nem.github.io/nem-dev-guide/09-mosaics"> <i class="fa fa-chevron-left"></i></a>
        <a class="nav nav-next" href="https://rb2nem.github.io/nem-dev-guide/80-debugging" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
    </div>

    </section>
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="https://rb2nem.github.io/nem-dev-guide//js/clipboard.min.js"></script>
    <script src="https://rb2nem.github.io/nem-dev-guide//js/perfect-scrollbar.min.js"></script>
    <script src="https://rb2nem.github.io/nem-dev-guide//js/perfect-scrollbar.jquery.min.js"></script>
    <script src="https://rb2nem.github.io/nem-dev-guide//js/jquery.sticky-kit.min.js"></script>
    <script src="https://rb2nem.github.io/nem-dev-guide//js/featherlight.min.js"></script>
    <script src="https://rb2nem.github.io/nem-dev-guide//js/html5shiv-printshiv.min.js"></script>
    <script src="https://rb2nem.github.io/nem-dev-guide//js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="https://rb2nem.github.io/nem-dev-guide//js/modernizr.custom.71422.js"></script>
    <script src="https://rb2nem.github.io/nem-dev-guide//js/learn.js"></script>
    <script src="https://rb2nem.github.io/nem-dev-guide//js/hugo-learn.js"></script>
    
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-96593681-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>


<script src="https://rb2nem.github.io/nem-dev-guide//js/tabs.js"></script>

  </body>
</html>

